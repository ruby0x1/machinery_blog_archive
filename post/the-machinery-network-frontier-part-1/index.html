











<!DOCTYPE html>
<html lang="en">

<head>

<script type="text/javascript" src="../../_static/js/bundle-playback.js@v=KTqwAcYd" charset="utf-8"></script>

<script type="text/javascript">
  
  

</script>
<link rel="stylesheet" type="text/css" href="../../_static/css/banner-styles.css@v=fantwOh2.css" />
<link rel="stylesheet" type="text/css" href="../../_static/css/iconochive.css@v=qtvMKcIJ.css" />
<!-- End Wayback Rewrite JS Include -->

  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/manifest.json">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="../../images/favicon.ico">
  <link rel="apple-touch-icon" href="../../images/apple-touch-icon.png"/>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="description" content="An introduction to Network and Multiplayer in The Machinery."/>
  

  
  <meta name="twitter:card" content="summary_large_image"/>
  
  
  <meta name="twitter:image" content="../../images/machinery-logo.png"/>
  
  <meta name="twitter:title" content="The (Machinery) Network Frontier -- Part 1">
  <meta name="twitter:description" content="An introduction to Network and Multiplayer in The Machinery."/>
  
  <meta name="twitter:site" content="@ourmachinery"/>

  
  <meta property="og:title" content="The (Machinery) Network Frontier -- Part 1 ¬∑ Our Machinery"/>
  <meta property="og:site_name" content="Our Machinery"/>
  <meta property="og:url" content=" ../../post/the-machinery-network-frontier-part-1/"/>
  
  <meta property="og:image" content="../../images/machinery-logo.png"/>
  
  
  <meta property="og:description" content="An introduction to Network and Multiplayer in The Machinery."/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content=" 2021-10-25T00:00:00Z"/>
  

  <title>The (Machinery) Network Frontier -- Part 1 &middot; Our Machinery</title>

  

  
  
  <link type="text/css" rel="stylesheet" href="../../css/bootstrap.min.css" media="screen, print"/>
  <link type="text/css" rel="stylesheet" href="../../css/style.min.css" media="screen, print"/>
  

  
  
  <link href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/index.xml" rel="alternate" type="application/rss+xml" title="Our Machinery"/>
  

  <link rel="canonical" href="index.html"/>

  
  
  <script>

      
    
    

  </script>
  

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>

  
  <link rel="stylesheet" href="../../cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css">
  <script src="../../cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  
  <script type="text/javascript" src="../../js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="../../js/page.min.js?v=1.16"></script>
  
  
  








<script type="application/ld+json">
{
    "@context": "http://web.archive.org/web/20211026015146/https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "url":"http:\/\/web.archive.org\/web\/20211026015146\/https:\/\/ourmachinery.com\/",
        "email":"ping@ourmachinery.com",
        "image": {
            "@type": "ImageObject",
            "url": "/images/full-logo.png"
        },
        "name":"Our Machinery",
        "description":""
    },
    "author": {
        "@type": "Person",
        "name": "Leonardo Lucania",
        "email": "ping@ourmachinery.com",
        
        "website":"http:\/\/web.archive.org\/web\/20211026015146\/https:\/\/ourmachinery.com\/"
        
        
        
    },
    "headline": "The (Machinery) Network Frontier -- Part 1",
    "name": "The (Machinery) Network Frontier -- Part 1",
    "wordCount":  1808 ,
    "timeRequired": "PT9M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": " ../../post/the-machinery-network-frontier-part-1/",
    "datePublished": "2021-10-25T00:00Z",
    "dateModified": "2021-10-25T00:00Z",
    
    
    "description": "An introduction to Network and Multiplayer in The Machinery."
}
    </script>


</head>
<body class="d-flex flex-column min-vh-100">
       <nav class="navbar navbar-expand-lg navbar-dark fixed-top bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="../../">
          <img src="../../images/full-logo.png" alt="Our Machinery Logo" width="250" height="75">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar" aria-controls="sidebar-1" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="d-none d-lg-block" id="navbarCollapse">
          <ul class="navbar-nav  ms-auto mb-2 mb-md-0 align-items-center">
            
            
            <li>
            <li class="nav-item">
               
            </li>
            </li>
            
            
            
            <li>
            <li class="nav-item">
               
            </li>
            </li>
            
            
            
             
            
            
            
             
            
            
            
             
            
            
            
            <li class="nav-item dropdown" style="height:40px;min-width:58px;">
              <a class="text-yellow fs-1 signed-in-only" style="line-height: 1;" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <ion-icon name="person-circle-outline"></ion-icon>
              </a>
              <a class="text-yellow fs-1 signed-out-only" style="line-height: 1;" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <ion-icon name="log-in-outline"></ion-icon>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item signed-out-only d-flex align-items-center" href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/sign-in.html">Sign In <ion-icon class="ms-auto" name="log-in-outline"></ion-icon></a></li>
                <li><a class="dropdown-item signed-out-only d-flex align-items-center" href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/sign-up.html">Sign Up <ion-icon class="ms-auto" name="create-outline"></ion-icon></a></li>
                <li><a class="dropdown-item signed-in-only d-flex align-items-center" href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/profile.html">Profile <ion-icon class="ms-auto" name="person-outline"></ion-icon></a></li>
                <li><a class="dropdown-item signed-in-only d-flex align-items-center" role="button" onclick="signOut(); return false;">Sign Out <ion-icon class="ms-auto" name="log-out-outline"></ion-icon></a></li>
              </ul>
            </li>
            
          </ul>
        </div>
      </div>


      <div id="sidebar" tabindex="-1" role="dialog" aria-modal="false" class="b-sidebar b-sidebar-right collapse shadow bg-dark text-light vh-100">
        <header class="b-sidebar-header">
          <button type="button" aria-label="Close" class="fs-1 btn btn-default text-light float-start" data-bs-toggle="collapse" data-bs-target="#sidebar" aria-controls="sidebar-1" aria-expanded="false" aria-label="Toggle navigation">
          <span class="icon icon-close"></span>
        </button>
        <div class=" d-flex justify-content-center">
        <a href="../../"><img src="../../images/full-logo.png" class="om-logo p-2 mb-2 mt-2" alt="Our Machinery Logo" width="100" height="75"></a>
  </div>
      </header>
          <div class="b-sidebar-body overflow-auto">
            <div class="card text-primary">
              
              <div class="card-body d-flex justify-content-center signed-out-only">
                <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/sign-in.html" aria-label="Login" class="btn btn-outline-primary me-2" style="flex: 1;"><span class="icon icon-user align-middle"></span> <span class="align-middle text-uppercase font-monospace">Sign In</span></a>
                <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/sign-up.html" aria-label="Register Account" class="btn btn-outline-primary" style="flex: 1;"><span class="icon icon-edit align-middle"></span> <span class="align-middle text-uppercase font-monospace">Sign Up</span></a>
              </div>
              
              <div class="card-body d-flex justify-content-center signed-in-only">
                <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/profile.html" aria-label="Open Profile" class="btn btn-outline-primary me-2 d-flex" style="max-height: 56; min-height: 56px;"><span class="align-middle align-self-center text-uppercase font-monospace">Profile</span></a>
                <a onclick="signOut(); return false;" class="btn btn-outline-primary  d-flex" style="max-height: 56; min-height: 56px;"><span class="icon icon-lock align-middle align-self-center"></span> <span class="align-middle align-self-center text-uppercase font-monospace">Logout</span></a>
              </div>
            </div>
            <div class="accordion mt-0" id="accordion-menu">
              
              
              
              
              
              
                <div class="accordion-item  bg-light">
                  <h2 class="accordion-header" id="heading-id2">
                    <button class="accordion-button bg-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-id2" aria-expanded="false" aria-controls="#collapse-id2">
                      About
                    </button>
                  </h2>
                  <div id="collapse-id2" class="accordion-collapse collapse" aria-labelledby="heading-id2" data-bs-parent="#accordion-menu">
                    <div class="accordion-body p-0">
                      <div class="list-group border-0">
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/product.html">The Machinery</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/roadmap.html">Roadmap</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/about.html">About Us</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/press.html">Press Kit</a>
                        
                      </div>
                    </div>
                  </div>
                </div>
                
              
              
                <div class="accordion-item  bg-light">
                  <h2 class="accordion-header" id="heading-id3">
                    <button class="accordion-button bg-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-id3" aria-expanded="false" aria-controls="#collapse-id3">
                      Learning &amp; Support
                    </button>
                  </h2>
                  <div id="collapse-id3" class="accordion-collapse collapse" aria-labelledby="heading-id3" data-bs-parent="#accordion-menu">
                    <div class="accordion-body p-0">
                      <div class="list-group border-0">
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/apidoc/apidoc.html">API Documentation</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.github.io/themachinery-books/">Books</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/videos.html">Videos</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/samples.html">Sample Projects</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://github.com/OurMachinery/themachinery-public/issues">Issue Tracker</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/academic.html">Academic License</a>
                        
                      </div>
                    </div>
                  </div>
                </div>
                
              
              
                <div class="accordion-item  bg-light">
                  <h2 class="accordion-header" id="heading-id4">
                    <button class="accordion-button bg-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-id4" aria-expanded="false" aria-controls="#collapse-id4">
                      Community
                    </button>
                  </h2>
                  <div id="collapse-id4" class="accordion-collapse collapse" aria-labelledby="heading-id4" data-bs-parent="#accordion-menu">
                    <div class="accordion-body p-0">
                      <div class="list-group border-0">
                        
                          <a class="list-group-item list-group-item-action border-0 " href=" ../../post/">Blog</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://discord.gg/SHHSZaH">Discord</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://github.com/OurMachinery/themachinery-public/discussions">Forum</a>
                        
                          <a class="list-group-item list-group-item-action border-0 " href="http://web.archive.org/web/20211026015146/https://anchor.fm/ourmachinery">Podcast</a>
                        
                      </div>
                    </div>
                  </div>
                </div>
                
              
            </div>
    </div>
  
    <footer class="b-sidebar-footer w-100">
      <div class="d-flex flex-row">
        <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/tutorials/" aria-label="Opens Tutorial" type="button" class="btn btn-outline-light m-1" style="flex: 1"> <span class="align-middle text-uppercase font-monospace">Tutorials</span></a>
        <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/apidoc/apidoc.html" aria-label="Opens API Documentation" type="button" class="btn btn-outline-light m-1" style="flex: 1"> <span class="align-middle text-uppercase font-monospace">Documentation</span></a>
    </div>

    
 

 
  </footer>
  
    </div>

    </nav>
  <main>


<section class="mt-5 container">

  <article class="post">
    <header class="post-blog mx-auto">
      <div class="mb-5 clearfix" role="group" aria-label="Basic example">
          <a href=" ../../" type="button" class="btn btn-primary float-start">
            <ion-icon name="chevron-back-outline" class="align-middle" style="padding-right:0.2em"></ion-icon> <span class="align-middle">All Blogs</span>
          </a>
          <div class="float-end">
          
           
        </div>
        </div>
      </div>

      <div class="d-grid d-md-flex gap-2 pb-3 pb-md-0 mb-2">
        <div class="flex-grow-1">
          <h1>The (Machinery) Network Frontier -- Part 1</h1>
        </div>
      </div>

      <p>
        <time class="post-date" datetime=" 2021-10-25T00:00:00Z">
          Oct 25, 2021
        </time>
      </p>



    </header>

    <section class="text-break post-blog mx-auto">
      <p>One of our goals for 2021 is to let users create multiplayer games with The Machinery. The systems
I‚Äôm going to describe in this blog post are not production-ready at this point in time (in fact
you can‚Äôt publish multiplayer-games at the moment), but we felt it was the right time to start
talking about how the network layer of The Machinery works under the hood, in the hope of helping
users to start to grasp its internals and begin to create multiplayer experiences as soon as
possible.</p>
<!-- more -->
<p>The post has been divided into three parts to make it more readable:</p>
<ul>
<li>Part 1 will introduce the goals of the systems and explain some basic concepts.</li>
<li>Part 2 will deal with higher-level concepts and how the user interacts with the networking layer in the editor.</li>
<li>Part 3 will drill down into the low-level implementation details of the network layer, examining the tradeoffs we‚Äôve made and looking at what‚Äôs currently missing.</li>
</ul>
<h2 id="goals-and-desired-features">Goals and desired features</h2>
<ol>
<li>
<p>Debuggability</p>
<p>Debugging multiplayer games is intrinsically more difficult as the number of possible ‚Äústates‚Äù
your game can be in at any given point doesn‚Äôt depend on a single executable but on two, three,
potentially more different ones running at the same time. One of the main goals of our network
system is to make it easy to debug multiplayer games directly in the editor. We want The
Machinery to be able to run many different ‚Äútypes‚Äù of network processes (for example a client, a
server, and a login-server) at the same time, in the same executable, behaving as close as
possible to when those processes are run on separate executables on separate machines. We also
want to make it so that you can simulate ‚Äúreal world‚Äù network conditions from within the editor
itself, making it possible to test corner-case scenarios without having to set up an actual
network.</p>
<p>Another thing we had in mind from day one is the concept of a ‚Äúnetwork profiler‚Äù. Imagine being
able to pause the game and inspect what packets were sent from the server to the client 10
frames ago. We want to natively support these kinds of workflows.</p>
</li>
<li>
<p>Easy to evolve and maintain</p>
<p>We don‚Äôt want to force users to strictly adhere to a specific network protocol like the
Server-Client model or other high-level network constructs like component data replication. We
want users to be able to create their own network protocol (one of my life goals is to take a
stab at a full P2P MMORPG üôÇ ), but we also want to provide a robust protocol out of the box
that developers can then customize as they want.</p>
<p>Being able to easily define new ‚Äúkinds‚Äù of data packets and how they should be handled is
another priority for us, as different games have different needs and they will surely need
custom packets to function properly. (Think about a fighting game, where you probably want to
transmit the <em>entire</em> state of your controller to the other peer every frame and avoid entity
replication altogether.)</p>
</li>
<li>
<p>Minimize friction when moving from single-player to multiplayer games, and vice-versa</p>
<p>It is generally considered easy to create the single-player version of a multiplayer game: just
run a server and a client locally, and everything will work. But this has the downside of not
being as ‚Äúoptimized‚Äù as a single-player-only game. It would be better to handle any messages
between the client and the server internally, instead of sending them over the network interface
(even localhost packets come with a cost).</p>
<p>On the other hand, it is considered pretty hard to create the multiplayer version of a
single-player game as an afterthought‚Ä¶ and for good reasons! When you implement a single-player
game you don‚Äôt need to transmit any messages at all as everything runs locally. Moving from
single-player to multiplayer will probably always mean a bunch of work, but we want to make it
as simple as possible in The Machinery. Fortunately for us, our visual scripting language is
event-based, so supporting ‚Äúremote events‚Äù can take us a big part of the way.</p>
</li>
<li>
<p>Automatization ‚Äúby default‚Äù, optimization when needed</p>
<p>You WILL need to optimize your network protocol before you ship your game, especially if you
want to support a large number of players over a small network. But the need for such
optimizations to happen <em>eventually</em> shouldn‚Äôt stand in the way of experimenting and playing
with multiplayer in the prototype phase.</p>
<p>So our goal is to make both the <em>Entity_Context</em> and <em>Entity_Graphs</em> multiplayer-ready by
default, even if the transmission of the data it‚Äôs not optimized. It should be very easy to
<em>start</em> and <em>prototype</em> multiplayer games, and then, later down the road, do the necessary
optimizations.</p>
</li>
</ol>
<p>The goal is not so much to <em>optimize</em> the networking layer of The Machinery ourselves (we will do
that too of course, but there are limits to what we can do since we need to be generic and support
all kinds of games), but to make it <em>easily optimizable</em>. That way you can prototype your
multiplayer game quickly knowing that you‚Äôll be able to optimize it when you need to and make
targeted optimizations that are customized for your specific game.</p>
<h2 id="basic-concepts">Basic Concepts</h2>
<h3 id="simulation-instance">Simulation Instance</h3>
<p>In The Machinery, every running simulation has its own <em>Entity Context</em> and is completely separated
from all the other simulations. If you have the editor open right now, chances are there are
probably four or five simulation instances going on, as any tab that needs to simulate something
(such as the Preview Tab, the Scene Tab, and the Simulate Tab) will have its own simulation
instance.</p>
<h3 id="network-node">Network Node</h3>
<p>A <em>Network Node</em> binds a specific simulation instance to an IP and port number. For example, in a
Client-Server multiplayer game, there will be one Server Network Node and potentially many
different Client Network Nodes running at the same time ‚Äî each one with its own simulation
instance running, potentially on different machines. You can think of the Internet as a giant graph
of nodes talking to each other, and we model that abstraction in The Machinery.</p>
<h3 id="pipe">Pipe</h3>
<p>A <em>Pipe</em> is what allows a specific node <code>n1</code> to transmit data of any kind to another node <code>n2</code>.
Note that the pipe is unilateral, so if <code>n2</code> needs to send messages to <code>n1</code> as well, it will need
to open another pipe that goes in the opposite direction.</p>
<p>Given two specific nodes <code>n1</code> and <code>n2</code>, only one pipe at a time can exist that goes from <code>n1</code> to
<code>n2</code> (and another from <code>n2</code> to <code>n1</code> of course). All the data that needs to be transmitted will go
through the same pipe.</p>
<h3 id="handshake">Handshake</h3>
<p>Assume <code>n1</code> wants to send some data to <code>n2</code>. <code>n1</code> will then request the <em>Network API</em> to open a
pipe to <code>n2</code> via <code>tm_network_api-&gt;open_pipe()</code>. The following things will happen:</p>
<ol>
<li>If a valid Pipe from <code>n1</code> to <code>n2</code> already exists, nothing needs to be done.</li>
<li>A 32-bit ever-incrementing integer is used as the <em>Pipe Identifier</em> (after a pipe is created the running index is incremented, so no two pipes starting from <code>n1</code> will ever have the same identifier)</li>
<li><code>n1</code> Sends a <em>Pipe Request</em> message to <code>n2</code> that contains the chosen pipe identifier</li>
<li>When <code>n2</code> receives the request, it decides whether or not the pipe request should be accepted</li>
<li><code>n2</code> sends a <em>Pipe Response</em> message to <code>n1</code> containing the 32-bit pipe identifier, and a <code>bool</code> that tells <code>n1</code> if the pipe request was accepted or not. (If <code>n2</code> has already accepted the pipe request and is receiving a duplicate request, then <code>true</code> is returned immediately).</li>
<li>If the request is accepted, <code>n1</code> now knows that <code>n2</code> is ready to receive messages, and can start to send any kind of data to <code>n2</code> via the pipe.</li>
</ol>
<p>Important Note: The way our connection handshake works at the moment is <em>not</em> definitive or
production-ready, it‚Äôs there only to allow users to start prototyping multiplayer games in the
editor. We will improve and add all the necessary features to our connection process in the
following releases.</p>
<h3 id="packet-type">Packet Type</h3>
<p>Every piece of data that <code>n1</code> sends to <code>n2</code> needs to be identified by a <em>Packet Type</em>. Doing so
allows <code>n2</code> to know how to interpret the data that <code>n1</code> sent on the pipe, but it also defines
things like retransmission policy and the necessity to send back ACKs.</p>
<p>A new packet type can be simply defined via the <code>tm_network_api-&gt;define_packet()</code> API, so that
later on data of that type can be transmitted via <code>tm_network_api-&gt;send()</code>. For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">tm_strhash_t packet_hash <span style="color:#f92672">=</span> tm_murmur_hash_string(<span style="color:#e6db74">&#34;test_packet&#34;</span>);
tm_network_api<span style="color:#f92672">-&gt;</span>define_packet(network, packet_hash,
    TM_NETWORK_GURANTEED_DELIVERY__DELIVER_ALL_ALLOW_DUPLICATES);

uint16_t port <span style="color:#f92672">=</span> <span style="color:#ae81ff">555</span>;
tm_network_node_o<span style="color:#f92672">*</span> node <span style="color:#f92672">=</span> tm_network_api<span style="color:#f92672">-&gt;</span>create_node(network, port);
tm_network_pipe_id pipe <span style="color:#f92672">=</span> tm_network_api<span style="color:#f92672">-&gt;</span>open_pipe(network, node,
  {.ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>, .port <span style="color:#f92672">=</span> <span style="color:#ae81ff">666</span>});

<span style="color:#66d9ef">while</span> (application_running) {
    <span style="color:#66d9ef">char</span> packet_data[<span style="color:#ae81ff">64</span>];
    sprintf(packet_data, <span style="color:#e6db74">&#34;hello world&#34;</span>);
    tm_network_api<span style="color:#f92672">-&gt;</span>send(network, pipe, packet_hash, packet_data,
        strlen(packet_data));
}
</code></pre></div><p>Note how we didn‚Äôt need to specify any other information when sending data other than the packet
type: just a pointer to the data and the size to be sent.</p>
<h3 id="guaranteed-delivery">Guaranteed Delivery</h3>
<p>As we are using <a href="http://web.archive.org/web/20211026015146/https://it.wikipedia.org/wiki/User_Datagram_Protocol">UDP</a> as the transmission
protocol for our packets under the hood, we require the users of the network API to specify what
kind of guaranteed delivery they want: maybe they don‚Äôt need any guarantee at all (it‚Äôs fine if
the packets arrive out of order or if they don‚Äôt arrive at all), or maybe they want the packets
to be received in the exact same order as they were sent. The network API makes sure that the
guaranteed delivery requests are fulfilled. (I‚Äôll give you some more details on this in the third
part of the blog post).</p>
<h3 id="network-interface">Network Interface</h3>
<p>A <em>Network</em> <em>Interface</em> is a specific piece of code (a callback for all intents and purposes)
that is executed when certain things happen in the networking layer, for example:</p>
<ul>
<li>A <code>receiver</code> interface is executed when a packet is received, if the interface returns true it means that the receiver correctly handled and dispatched the packet.</li>
<li>A <code>bootstrapper</code> interface is executed just after the network node is created.</li>
<li>An <code>accepter</code> is executed when a pipe request message is received: if the return value is <code>true</code>, the pipe request is accepted.</li>
</ul>
<p>Network interfaces are basically modular pieces that can be associated with network nodes via
<em>Network Node Assets</em> (we will talk about them in the next post). Of course, multiple interfaces of
the same type can be associated with a network node.</p>
<p>Note that network interfaces are registered exactly like any other interface in The Machinery:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bootstrap_client</span>(<span style="color:#66d9ef">struct</span> tm_network_o <span style="color:#f92672">*</span>network, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>network_context,
    <span style="color:#66d9ef">struct</span> tm_network_node_o <span style="color:#f92672">*</span>node)
{
    tm_network_pipe_id pipe <span style="color:#f92672">=</span> tm_network_api<span style="color:#f92672">-&gt;</span>open_pipe(network, node,
        {.ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>, .port <span style="color:#f92672">=</span> <span style="color:#ae81ff">666</span>});

    <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>}

<span style="color:#66d9ef">static</span> tm_network_bootstrap_i <span style="color:#f92672">*</span>bootstrap_client_i <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>(tm_network_bootstrap_i){
    .name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bootstrap_client&#34;</span>, 
    .bootstrap <span style="color:#f92672">=</span> bootstrap_client
};

tm_add_or_remove_implementation(reg, load, tm_network_bootstrap_i,
    bootstrap_client_i);
</code></pre></div><p>In the next part, we‚Äôll take a look at how we combined these basic building blocks to create more
high-level constructs like <em>Network Assets</em>, <em>Entity Context and Graph Events</em>
<em>Synchronization</em>, and the <em>Network Profiler</em>.</p>

      


<section>
  <h5>by <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/authors/leo" class="text-decoration-none">Leonardo Lucania</a></h5>
</section>


    </section>
    <footer class="mt-5 mb-5">
      <hr>

      <div class="d-flex">
    <div class="me-auto">
        <a href=" ../../post" type="button" class="btn btn-primary">
            <ion-icon name="chevron-back-outline" class="align-middle" style="padding-right:0.2em"></ion-icon> <span class="align-middle">All Blogs</span>
        </a>
    </div>
    
    <a class="icon icon-twitter me-1" style="font-size: 1.2em" href="http://web.archive.org/web/20211026015146/https://twitter.com/share?text=The%20%28Machinery%29%20Network%20Frontier%20--%20Part%201¬†-¬†Our%20Machinery&amp;url=https%3a%2f%2fourmachinery.com%2fpost%2fthe-machinery-network-frontier-part-1%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon icon-pinterest me-1" style="font-size: 1.2em" href="http://web.archive.org/web/20211026015146/https://pinterest.com/pin/create/button/?url=https%3a%2f%2fourmachinery.com%2fpost%2fthe-machinery-network-frontier-part-1%2f&amp;description=The%20%28Machinery%29%20Network%20Frontier%20--%20Part%201" onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
        <span class="hidden">Pinterest</span>
    </a>
    
</div>

      <div class="mt-5">
        

<p>The comment system uses a session cookie to keep track of your signed-in status. This cookie is
created when you sign in with GitHub. If you don't sign in, no cookie is created.</p>




      </div>

      
      <div class="container mb-5 mt-5">
        <div class="row">
          <h3>Previous Posts</h3>
          <hr>
        </div>
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
          
              <div class="col">
              <div class="card om-post-preview shadow-sm">
                
                <a href=" ../../post/api-versioning/" class="text-decoration-none"><img src="../../images/apiver__dependencies.png" class="card-img-top" alt="API Versioning"></a>
                
                <div class="card-body">
                  <h5 class="card-title"><a class="text-decoration-none" href=" ../../post/api-versioning/">API Versioning</a></h5>
                  <h6 class="card-subtitle mb-2 text-muted">
                    <time class="post-date" datetime=" 2021-09-22T00:00:00Z">
                      22 Sep 2021
                    </time>
                  </h6>
                  <p class="card-text">The plugin API system is one of the central pieces of technology in The Machinery. Plugins can use it to call APIs ‚Ä¶</p>
                </div>
                <div class="d-flex justify-content-between align-items-center p-2">
                  <div class="btn-group">
                    <a href=" ../../post/api-versioning/" type="button" class="btn btn-lg btn-outline-primary">Read</a>
                  </div>
                  <small class="text-muted">29 min</small>
                </div>
              </div>
        </div>
         <div class="col">
              <div class="card om-post-preview shadow-sm">
                
                <a href=" ../../post/save-game-system-part-3/" class="text-decoration-none"><img src="../../images/sgs3__pong.gif" class="card-img-top" alt="One-Click Save Game System -- Part 3"></a>
                
                <div class="card-body">
                  <h5 class="card-title"><a class="text-decoration-none" href=" ../../post/save-game-system-part-3/">One-Click Save Game System -- Part 3</a></h5>
                  <h6 class="card-subtitle mb-2 text-muted">
                    <time class="post-date" datetime=" 2021-09-10T00:00:00Z">
                      10 Sep 2021
                    </time>
                  </h6>
                  <p class="card-text">Our very simple project was now working as expected, but there were a bunch of issues we still had to address:</p>
                </div>
                <div class="d-flex justify-content-between align-items-center p-2">
                  <div class="btn-group">
                    <a href=" ../../post/save-game-system-part-3/" type="button" class="btn btn-lg btn-outline-primary">Read</a>
                  </div>
                  <small class="text-muted">7 min</small>
                </div>
              </div>
        </div>
         <div class="col">
              <div class="card om-post-preview shadow-sm">
                
                <a href=" ../../post/procedural-forest-sample/" class="text-decoration-none"><img src="../../images/procforest__screenshot.png" class="card-img-top" alt="Procedural Forest Sample"></a>
                
                <div class="card-body">
                  <h5 class="card-title"><a class="text-decoration-none" href=" ../../post/procedural-forest-sample/">Procedural Forest Sample</a></h5>
                  <h6 class="card-subtitle mb-2 text-muted">
                    <time class="post-date" datetime=" 2021-09-03T00:00:00Z">
                      3 Sep 2021
                    </time>
                  </h6>
                  <p class="card-text">Today we are releasing a new sample project for The Machinery that we call Procedural Forest. It is our own ‚Ä¶</p>
                </div>
                <div class="d-flex justify-content-between align-items-center p-2">
                  <div class="btn-group">
                    <a href=" ../../post/procedural-forest-sample/" type="button" class="btn btn-lg btn-outline-primary">Read</a>
                  </div>
                  <small class="text-muted">2 min</small>
                </div>
              </div>
        </div>
        
      </div>
      </div>
    </footer>
  </article>

</section>

</main>

<footer class="container-fluid mt-auto page-footer-bg">
    <div class="mx-auto d-flex justify-content-center w-100 pt-5 pb-5">
        <img alt="trees" src=" ../../post/the-machinery-network-frontier-part-1/&#32;https:/ourmachinery.com/images/trees.png" style="height: 84.38px; width: 150px;">
    </div>
    <div class="page-info">
        <p class="float-end">
            
            <a href="http://web.archive.org/web/20211026015146/https://twitter.com/ourmachinery" target="_blank" class="icon icon-twitter fs-4"></a>
            
            <a href="http://web.archive.org/web/20211026015146/https://instagram.com/ourmachinery" target="_blank" class="icon icon-instagram fs-4"></a>
            
            <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/index.xml" target="_blank" class="icon icon-feed fs-4"></a>
            
            <a href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/cdn-cgi/l/email-protection#cbbba2a5ac8ba4beb9a6aaa8a3a2a5aeb9b2e5a8a4a6" target="_blank" class="icon icon-mail fs-4"></a>
            
        </p>
        <p>&copy; Our Machinery 2021 <a style="text-decoration:none; margin-left:1em;" href="http://web.archive.org/web/20211026015146/https://ourmachinery.com/privacy.html">Privacy Policy</a></p>
    </div>
</footer>

<script type="module" src="../../unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule="" src="../../unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.js"></script>
</body>

</html><!--
     FILE ARCHIVED ON 01:51:46 Oct 26, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 00:51:28 Aug 01, 2022.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 68.835
  exclusion.robots: 0.082
  exclusion.robots.policy: 0.075
  cdx.remote: 0.058
  esindex: 0.009
  LoadShardBlock: 44.103 (3)
  PetaboxLoader3.datanode: 44.186 (5)
  CDXLines.iter: 13.629 (3)
  load_resource: 93.393
  PetaboxLoader3.resolve: 68.352
  loaddict: 21.491
-->